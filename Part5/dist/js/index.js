(()=>{var t={625:()=>{Vue.component("cart-list",{props:["cartItems"],template:'\n        <div class="cart-list">\n            <cart-item v-bind:key="index" v-bind:id="item.id_product" v-bind:data-index="index" v-for="(item, index) in cartItems" :item="item" :index="index"></cart-item>\n        </div>\n    '})},907:()=>{Vue.component("error",{template:'\n        <div class="modal">\n            <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                <h3 class="modal-title">ERROR</h3>\n                <a href="#" title="Close" class="close">×</a>\n                </div>\n                <div class="modal-body">    \n                <p>Ошибка загрузки</p>\n                </div>\n            </div>\n            </div>\n        </div>\n    '})},319:()=>{Vue.component("goods-list",{props:["goods"],template:'\n        <div class="goods-list">\n            <goods-item v-bind:key="index" v-bind:id="item.id_product" v-for="(item, index) in goods" :good="item" v-if="goods.length != 0"></goods-item>\n            <div class="goods-item" v-if="goods.length == 0">Нет данных</div>\n        </div>\n    '})},961:()=>{Vue.component("search-wrap",{data:function(){return{searchLine:""}},template:'\n        <div class="search-wrap">\n            <input type="text" class="goods-search" @keydown.enter="filterGoods" v-model="searchLine"></input>\n            <button class="search-button" type="button" @click="filterGoods">Искать</button>\n        </div>\n    ',methods:{filterGoods(){const t=new RegExp(this.searchLine,"i");this.$root.filteredGoods=this.$root.goods.filter((e=>t.test(e.product_name)))}}})}},e={};function o(a){var i=e[a];if(void 0!==i)return i.exports;var s=e[a]={exports:{}};return t[a](s,s.exports,o),s.exports}(()=>{"use strict";const t="http://localhost:3000";o(961),o(319),Vue.component("goods-item",{props:["good"],template:'\n        <div class="goods-item">\n            <h3 class="goods-item__title">{{ good.product_name }}</h3>\n            <p class="goods-item__price">{{ good.price }}</p>\n            <button type="button" class="buy-button" @click="addToCart()">Купить</button>\n        </div>\n    ',methods:{async addToCart(){try{await fetch(`${t}/addToCart`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(this.good)})}catch(t){this.$root.errorWindow()}this.$root.renderCart()}}}),o(625),Vue.component("cart-item",{props:["item","index"],template:'\n        <div class="cart-item">\n            <h3 class="cart-item__title">{{ item.product_name }}</h3>\n            <p class="cart-item__price">{{ item.price }}</p>\n            <button type="button" class="del-button" @click=delItem(index)>Удалить</button>\n        </div>\n    ',methods:{async delItem(e){let o={index:e};try{await fetch(`${t}/delFromCart`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(o)})}catch(t){this.$root.errorWindow()}this.$root.renderCart()}}}),o(907);const e=new Vue({el:"#app",data:{goods:[],filteredGoods:[],searchLine:"",cartItems:[],total:0},methods:{async fetchGoods(){try{let e=await fetch(`${t}/catalogData`);this.goods=await e.json(),this.filteredGoods=this.goods}catch(t){this.errorWindow()}},async renderCart(){try{let e=await fetch(`${t}/cartData`);this.cartItems=await e.json(),this.totalValue()}catch(t){this.errorWindow()}},async totalValue(){try{let e=await fetch(`${t}/totalValue`),o=await e.json();this.total=o.total}catch(t){this.errorWindow()}},async clearCart(){try{await fetch(`${t}/clearCart`)}catch(t){e.errorWindow()}this.renderCart()},async clearStats(){try{await fetch(`${t}/clearStats`)}catch(t){this.errorWindow()}},errorWindow(){const t=document.querySelector(".modal").classList;t.add("active"),document.querySelector(".close").addEventListener("click",(()=>{t.toggle("active")}))}},async mounted(){await this.fetchGoods()}})})()})();